<div class="checker-container" *ngIf="config">

    <!-- 条件入力フォーム -->
    <mat-card class="form-card">
        <mat-card-content class="form-card-content">
    
            <!-- 左半分: 入力フォーム -->
            <div class="form-container">
                <!-- チェック対象グループごとにループ -->
                <div *ngFor="let target of config.checkTargets" class="check-target-group">
                    <h4 class="target-title">{{ target.title }}</h4>
                    <!-- 行ごとにループ -->
                    <div *ngFor="let row of target.fieldRows" class="form-row">
                        <!-- フィールドごとにループ -->
                        <mat-form-field *ngFor="let field of row.fields" [ngClass]="field.class" appearance="outline">
                            <mat-label>{{ field.label }}</mat-label>
                            <input matInput [(ngModel)]="field.value" [type]="field.type" [disabled]="isRunning">
                        </mat-form-field>
                    </div>
                </div>
            </div>
    
            <!-- 右半分: SVG画像 -->
            <div class="image-container">
                <img [src]="'assets/images/' + mode + '.svg'" [alt]="config.title + ' の構成図'">
            </div>
    
        </mat-card-content>
        <mat-card-actions>
            <button mat-raised-button color="primary" (click)="runCheck()" [disabled]="isRunning">
                <mat-icon>play_arrow</mat-icon>
                チェック実行
            </button>
        </mat-card-actions>
    </mat-card>

    <!-- 実行中のプログレスバー -->
    <mat-progress-bar mode="indeterminate" *ngIf="isRunning"></mat-progress-bar>

    <!-- 実行結果表示エリア -->
    <mat-card class="log-card">
        <mat-card-header>
            <mat-card-title>実行結果</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <pre #logContainer class="log-output" [innerHTML]="logOutput"></pre>
        </mat-card-content>
        <mat-card-actions>
            <button mat-stroked-button color="primary" (click)="saveLog()" [disabled]="isRunning || !logOutput">
                <mat-icon>save_alt</mat-icon>
                結果をファイルに出力
            </button>
        </mat-card-actions>
    </mat-card>
</div>