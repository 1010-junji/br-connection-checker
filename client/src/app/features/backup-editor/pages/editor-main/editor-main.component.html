<div class="editor-container">
    <!-- ファイル選択＆処理実行セクション -->
    <mat-card>
        <mat-card-header>
            <mat-icon mat-card-avatar fontSet="material-icons-two-tone">dynamic_form</mat-icon>
            <mat-card-title>バックアップファイル編集・再構成ツール</mat-card-title>
            <mat-card-subtitle>Management Consoleから出力したZIP形式のバックアップファイルを編集します。</mat-card-subtitle>
        </mat-card-header>
    
        <mat-card-content class="card-content-container">
            <section class="step-section">
                <div class="step-header">
                    <mat-icon class="step-icon">archive</mat-icon>
                    <div class="step-title-group">
                        <h3 class="step-title">1. バックアップファイル選択</h3>
                        <p class="step-subtitle">クラスター情報を切り替えるZIPファイルを選択します。</p>
                    </div>
                </div>
                <div class="step-content-r">
                    <button mat-stroked-button color="primary" (click)="selectFile()" [disabled]="isRunning">
                        <mat-icon>folder_open</mat-icon>
                        ファイルを選択...
                    </button>
                    <div *ngIf="selectedFilePath" class="selected-file-info">
                        <mat-icon class="file-icon">description</mat-icon>
                        <span>{{ fileName }}</span>
                    </div>
                </div>
            </section>
    
            <section class="step-section">
                <div class="step-header">
                    <mat-icon class="step-icon">play_circle_filled</mat-icon>
                    <div class="step-title-group">
                        <h3 class="step-title">2. 処理実行</h3>
                        <p class="step-subtitle">ファイル内のクラスター情報をトグルします。</p>
                    </div>
                </div>
                <div class="step-content-c">
                    <pre class="description-text">
<strong>処理内容:</strong>
指定されたZIPファイルを分析し、クラスター設定（Production <---> Non Production）を切り替えます。
処理後、"switched_元のファイル名.zip" という名前で新しいZIPファイルが出力されます。</pre>
                    <mat-card-actions align="end" class="step-actions">
                        <button mat-raised-button color="primary" (click)="processFile()"
                            [disabled]="!selectedFilePath || isRunning">
                            処理を実行
                        </button>
                    </mat-card-actions>
                </div>
            </section>
        </mat-card-content>
    </mat-card>

    <!-- 実行中のプログレスバー -->
    <mat-progress-bar mode="indeterminate" *ngIf="isRunning"></mat-progress-bar>

    <!-- 3. 実行ログセクション -->
    <mat-card *ngIf="logOutput.length > 0 || isRunning">
            <mat-card-header>
                <mat-card-title>実行結果</mat-card-title>
            </mat-card-header>
        <mat-card-content class="log-content">
            <pre class="log-output">
            <div *ngFor="let log of logOutput" [ngClass]="'log-' + log.type">{{ log.message }}</div>
        </pre>
        </mat-card-content>
    </mat-card>
</div>